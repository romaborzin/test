<!DOCTYPE HTML>
<html>
 <head>
  <meta charset="utf-8">
  <title>Тестовое задание</title>
  <style type="text/css">
      .box{
        float: left;
        width: 15vw; height:
        15vw;border:1px solid red;
        margin: 2vw;
        display: flex;
  align-items: center;
  justify-content: center
      }
  </style>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.20/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.20/themes/base/jquery-ui.css">
  <script>
  $(function() {
    
    $('#dialog').dialog({
        autoOpen: false,
        modal:true,
        hide: { effect: "blind", duration: 500 },
        show: { effect: "blind", duration: 500 }
    });
    

    $('div.box').click(function(e){
        $('#dialog').dialog("open")
        $("#dialog").text(this.id);
    });

    $(".ui-widget-overlay").live("click", function(){
    // Проверяем, что открыт нужный нам диалог
    // на случай, что закрывать нужно не все
    var isOpen = $( "#dialog" ).dialog( "isOpen" );
    if(isOpen){
        $("#dialog").dialog( "close" );    
    }
    });
     
     $('input:checkbox').click(function(){
    if ($(this).is(':checked')) {
        $( ".box:odd" ).css( "background-color", "gray");
        $( ".box:odd" ).css( "color", "white");
    } else {
        $( ".box:odd" ).css( "background-color", "white");
        $( ".box:odd" ).css( "color", "black");
    }
    });       

    

    $('.btn').click(function() {
        var idd = $('.box').last();
        var nw = idd[0].id-(-1);
        var txt2 = '<div class="box" id="'+nw+'"><p>'+nw+'</p></div>';   // Создаем элемент при помощи jQuery
  
        $('.parent').append(txt2);
    });
    
});
  </script>
 </head>
 <body>
<div id="dialog" title="Блок №">
</div>

<label><input type="checkbox" id="check" onchange="fun1()"> Смена цвета</label>
<div class="parent" style="width: 100%;">

        <div class="box" id="1"><p>1</p></div>
        <div class="box" id="2"><p>2</p></div>
        <div class="box" id="3"><p>3</p></div>
        <div class="box" id="4"><p>4</p></div>
</div>
<button class="btn">Добавить элемент</button>
 </body>
</html>